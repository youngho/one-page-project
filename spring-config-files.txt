<!-- pom.xml -->
<?xml version="1.0" encoding="UTF-8"?>
<project xmlns="http://maven.apache.org/POM/4.0.0"
         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 
         https://maven.apache.org/xsd/maven-4.0.0.xsd">
    <modelVersion>4.0.0</modelVersion>
    
    <parent>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-starter-parent</artifactId>
        <version>3.2.0</version>
        <relativePath/>
    </parent>
    
    <groupId>com.portfolio</groupId>
    <artifactId>portfolio-backend</artifactId>
    <version>1.0.0</version>
    <name>Portfolio Backend</name>
    <description>Interactive Portfolio Backend with Spring Boot</description>
    
    <properties>
        <java.version>17</java.version>
    </properties>
    
    <dependencies>
        <!-- Spring Boot Web -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-web</artifactId>
        </dependency>
        
        <!-- Spring Boot Data JPA -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-data-jpa</artifactId>
        </dependency>
        
        <!-- MariaDB Driver -->
        <dependency>
            <groupId>org.mariadb.jdbc</groupId>
            <artifactId>mariadb-java-client</artifactId>
            <scope>runtime</scope>
        </dependency>
        
        <!-- Lombok -->
        <dependency>
            <groupId>org.projectlombok</groupId>
            <artifactId>lombok</artifactId>
            <optional>true</optional>
        </dependency>
        
        <!-- Spring Boot DevTools -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-devtools</artifactId>
            <scope>runtime</scope>
            <optional>true</optional>
        </dependency>
        
        <!-- Validation -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-validation</artifactId>
        </dependency>
        
        <!-- Test -->
        <dependency>
            <groupId>org.springframework.boot</groupId>
            <artifactId>spring-boot-starter-test</artifactId>
            <scope>test</scope>
        </dependency>
    </dependencies>
    
    <build>
        <plugins>
            <plugin>
                <groupId>org.springframework.boot</groupId>
                <artifactId>spring-boot-maven-plugin</artifactId>
                <configuration>
                    <excludes>
                        <exclude>
                            <groupId>org.projectlombok</groupId>
                            <artifactId>lombok</artifactId>
                        </exclude>
                    </excludes>
                </configuration>
            </plugin>
        </plugins>
    </build>
</project>

<!-- 
===============================================
application.yml íŒŒì¼
íŒŒì¼ ìœ„ì¹˜: src/main/resources/application.yml
===============================================
-->
<!--
spring:
  application:
    name: portfolio-backend
    
  datasource:
    url: jdbc:mariadb://localhost:3306/portfolio_db?useUnicode=true&characterEncoding=utf8
    username: root
    password: your_password
    driver-class-name: org.mariadb.jdbc.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
  
  jpa:
    hibernate:
      ddl-auto: update  # ê°œë°œ: update, ìš´ì˜: validate
    show-sql: true
    properties:
      hibernate:
        dialect: org.hibernate.dialect.MariaDBDialect
        format_sql: true
        use_sql_comments: true
    open-in-view: false
    
server:
  port: 8080
  servlet:
    context-path: /
    encoding:
      charset: UTF-8
      enabled: true
      force: true

logging:
  level:
    root: INFO
    com.portfolio: DEBUG
    org.hibernate.SQL: DEBUG
    org.hibernate.type.descriptor.sql.BasicBinder: TRACE
  pattern:
    console: "%d{yyyy-MM-dd HH:mm:ss} - %msg%n"

# CORS ì„¤ì • (í•„ìš”ì‹œ)
cors:
  allowed-origins: "*"
  allowed-methods: GET,POST,PUT,DELETE,OPTIONS
  allowed-headers: "*"
  max-age: 3600
-->

<!--
===============================================
ë°ì´í„°ë² ì´ìŠ¤ ìƒì„± ìŠ¤í¬ë¦½íŠ¸
íŒŒì¼ ìœ„ì¹˜: database/schema.sql
===============================================
-->
<!--
-- ë°ì´í„°ë² ì´ìŠ¤ ìƒì„±
CREATE DATABASE IF NOT EXISTS portfolio_db 
CHARACTER SET utf8mb4 
COLLATE utf8mb4_unicode_ci;

USE portfolio_db;

-- í”„ë¡œì íŠ¸ í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS projects (
    id BIGINT AUTO_INCREMENT PRIMARY KEY,
    username VARCHAR(100) NOT NULL,
    project_id VARCHAR(50) NOT NULL,
    title VARCHAR(255) NOT NULL,
    description TEXT,
    tags TEXT,
    position_x DOUBLE NOT NULL,
    position_y DOUBLE NOT NULL,
    created_at DATETIME DEFAULT CURRENT_TIMESTAMP,
    updated_at DATETIME DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
    
    -- ì¸ë±ìŠ¤ ì¶”ê°€
    INDEX idx_username (username),
    INDEX idx_project_id (project_id),
    UNIQUE KEY uk_username_projectid (username, project_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ìƒ˜í”Œ ë°ì´í„° ì‚½ìž…
INSERT INTO projects (username, project_id, title, description, tags, position_x, position_y) VALUES
('testuser', 'p1', 'ðŸŽ¨ ì²« í”„ë¡œì íŠ¸', 'ì—¬ê¸°ì— í”„ë¡œì íŠ¸ë¥¼ ì¶”ê°€í•´ë³´ì„¸ìš”!', '["ì‹œìž‘í•˜ê¸°"]', 400, 300),
('testuser', 'p2', 'ðŸš€ ë‘ ë²ˆì§¸ í”„ë¡œì íŠ¸', 'ë©‹ì§„ í”„ë¡œì íŠ¸ìž…ë‹ˆë‹¤', '["React", "Spring Boot"]', 600, 400);

-- ì‚¬ìš©ìžë³„ í”„ë¡œì íŠ¸ ì¡°íšŒ ì¿¼ë¦¬
SELECT * FROM projects WHERE username = 'testuser';

-- í”„ë¡œì íŠ¸ í†µê³„ ì¿¼ë¦¬
SELECT username, COUNT(*) as project_count 
FROM projects 
GROUP BY username;
-->